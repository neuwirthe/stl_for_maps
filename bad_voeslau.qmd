---
title: "Bad Vöslau"
format: html
editor: source
---



```{r}
suppressPackageStartupMessages({
  library(tidyverse)
  library(readxl)
  library(scales)
  library(fs)
  library(here)
  library(sf)
  library(curl)
  library(terra)
  library(rmapshaper)
})
```

```{r}
load(path(here(),"vector_data", "verwaltungsgrenzen",
          "verwaltungsgrenzen_50.RData"))
```

```{r}
verwaltungsgrenzen_50 |>
  names()
```

```{r}
verwaltungsgrenzen_50 |>
  filter(PG=="Bad Vöslau") ->
  kat_voeslau
```

```{r}
verwaltungsgrenzen_50 |>
  filter(PG=="Bad Vöslau") |>
  group_by(GKZ) |>
  summarise(geometry=st_union(geometry)) ->
  voeslau_gem
```

```{r}
border <- vect(voeslau_gem)
```

```{r}
border |>
  project("EPSG:31256") ->
  border_31256
ext(border_31256)
```
```{r}
border |>
  project("EPSG:4326") ->
  border_4326
ext(border_4326)  
```

```{r}
noe_raster_31256 <-
rast(path(here(),"raster_data", "gelaende",
          "niederoesterreich","noe_raster_10m_31256.tif"))  
  
```

```{r}
r_crop <- crop(noe_raster_31256,border_31256)
voeslau_raster <- mask(r_crop, border_31256)
voeslau_raster |>
  plot()
```

```{r}
voeslau_raster |>
  writeRaster(path(here(),"for_stl",
                   "voeslau_gelaende.tif"),
              overwrite=TRUE)
```

Peojektion braucht mehrere Minuten

```{r}
rast(path(here(), "raster_data", "oberflaeche", "oesterreich",
          "ALS_DTM_CRS3035RES50000mN2750000E4750000.tif")) ->
  noe_31259
```

```{r}
noe_31259 |> 
  crs() |>
  cat()
```

```{r}
noe_31259 |>
  project("EPSG:31256") ->
  noe_raster_31256
```

```{r}
noe_raster_31256 |> 
  crs() |>
  cat()
```






```{r}
r_crop <- crop(noe_raster_31256,border_31256)
voeslau_ober <- mask(r_crop,border_31256)
voeslau_ober |>
  plot()
```
```{r}
e <- ext(-8000,-7000,314000,315000)
voes_1 <-
  crop(voeslau_ober,e)
```
```{r}
voes_1 |>
  plot()
```
```{r}
voes_1 |>
  writeRaster(path(here(),"for_stl",
                   "voes_1.tif"),
              overwrite=TRUE
  )
```

